% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Transform_CumCount.R
\name{Transform_CumCount}
\alias{Transform_CumCount}
\title{Transform Cumulative Counts to Study Level}
\usage{
Transform_CumCount(dfInput, vBy, nMinDenominator = 25, tblMonthSequence = NULL)
}
\arguments{
\item{dfInput}{data.frame or tbl. Output from Input_CountSiteByMonth with columns:
GroupID, GroupLevel, Numerator, Denominator, Metric, StudyID, MonthYYYYMM.
Note: Input should contain monthly (not cumulative) counts. This function
calculates cumulative sums at the study level.}

\item{vBy}{character. Vector of column names for grouping (e.g., "StudyID" or
c("StudyID", "BootstrapRep")).}

\item{nMinDenominator}{numeric. Minimum cumulative denominator threshold for
filtering early/sparse data (default: 25).}

\item{tblMonthSequence}{tbl_lazy, data.frame, or NULL. For lazy table inputs:
Optional pre-generated complete month sequences. Must contain columns matching
vBy and MonthYYYYMM with NO gaps. If NULL, attempts to create temp table
(requires write privileges). If data.frame provided, will be written to temp table.}
}
\value{
A data.frame with study-level aggregated cumulative counts and ratios.
Output columns: \code{vBy} columns, \code{MonthYYYYMM}, \code{StudyMonth}, \code{Numerator},
\code{Denominator}, \code{Metric}, \code{GroupCount}.
Note: \code{Numerator} and \code{Denominator} are cumulative sums. \code{Metric} is the ratio.
}
\description{
Transforms site-level cumulative counts into study-level metrics by aggregating
across groups (sites/countries) by calendar month. Creates sequential study months,
applies minimum denominator filtering, and calculates cumulative metrics.
Supports both in-memory data frames and dbplyr lazy tables.
}
\examples{
# Generate input data
dfSubjects <- clindata::rawplus_dm
dfNumerator <- clindata::rawplus_ae
dfDenominator <- clindata::rawplus_visdt

dfInput <- Input_CountSiteByMonth(
  dfSubjects = dfSubjects,
  dfNumerator = dfNumerator,
  dfDenominator = dfDenominator,
  strNumeratorDateCol = "aest_dt",
  strDenominatorDateCol = "visit_dt"
)

# Transform to study level
dfTransformed <- Transform_CumCount(
  dfInput = dfInput,
  vBy = "StudyID",
  nMinDenominator = 25
)

print(dfTransformed)

}
