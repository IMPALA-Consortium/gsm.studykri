% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Visualize_StudyKRI.R
\name{Visualize_StudyKRI}
\alias{Visualize_StudyKRI}
\title{Visualize Study KRI with Confidence Intervals}
\usage{
Visualize_StudyKRI(
  dfStudyKRI,
  dfBoundsRef,
  dfBounds = NULL,
  strStudyID,
  strStudyMonthCol = "StudyMonth",
  strMetricCol = "Metric",
  nMaxMonth = NULL,
  strTitle = NULL,
  strSubtitle = NULL,
  strYlab = "Metric",
  strXlab = "Study Month"
)
}
\arguments{
\item{dfStudyKRI}{data.frame. Actual study-level metric data from \code{Transform_CumCount}.
Must contain columns specified by \code{strStudyMonthCol} and \code{strMetricCol}.
If a \code{StudyID} column exists, data will be automatically filtered to \code{strStudyID}.}

\item{dfBoundsRef}{data.frame or NULL. Portfolio/comparison group confidence intervals
from \code{Analyze_StudyKRI_PredictBoundsRef} (optional). If provided, must contain: \code{StudyMonth},
\code{MedianMetric}, \code{LowerBound}, \code{UpperBound}. Set to NULL for reference-only studies.}

\item{dfBounds}{data.frame or NULL. Individual study confidence intervals
from \code{Analyze_StudyKRI_PredictBounds} (optional). If a \code{StudyID} column exists,
data will be automatically filtered to \code{strStudyID}. If provided, must contain:
\code{StudyMonth}, \code{MedianMetric}, \code{LowerBound}, \code{UpperBound}.}

\item{strStudyID}{character. Study ID to filter data and display in title/subtitle.}

\item{strStudyMonthCol}{character. Column name for study month (default: "StudyMonth").}

\item{strMetricCol}{character. Column name for metric (default: "Metric").}

\item{nMaxMonth}{integer or NULL. Maximum study month to display. If NULL (default),
shows all available months.}

\item{strTitle}{character or NULL. Plot title. If NULL, generates default title.}

\item{strSubtitle}{character or NULL. Plot subtitle. If NULL, generates default
showing comparison study count.}

\item{strYlab}{character. Y-axis label (default: "Metric").}

\item{strXlab}{character. X-axis label (default: "Study Month").}
}
\value{
A ggplot2 object that can be displayed, saved, or further customized.
}
\description{
Creates a layered visualization comparing a study's KRI metric against portfolio
confidence intervals. The plot shows:
\itemize{
\item Portfolio/comparison group confidence intervals (light blue ribbon)
\item Individual study confidence intervals (orange ribbon, optional)
\item Actual study metric line (black line with points)
}

This visualization helps identify when a study's performance deviates from
expected portfolio norms.
}
\examples{
\dontrun{
# Assuming workflow has been run
lAnalysis <- lAnalyzed$Analysis_kri0001

# Define target study
target_study <- "STUDY1"

# Option 1: Pass full datasets - function will filter automatically
p <- Visualize_StudyKRI(
  dfStudyKRI = lAnalysis$Analysis_Transformed,
  dfBoundsRef = lAnalysis$Analysis_BoundsRef,
  dfBounds = lAnalysis$Analysis_Bounds,
  strStudyID = target_study,
  strYlab = "Cumulative AE Rate per Visit"
)

# Option 2: Pre-filter data manually (equivalent to above)
dfStudyKRI <- lAnalysis$Analysis_Transformed[
  lAnalysis$Analysis_Transformed$StudyID == target_study, ]
dfBounds <- lAnalysis$Analysis_Bounds[
  lAnalysis$Analysis_Bounds$StudyID == target_study, ]

p <- Visualize_StudyKRI(
  dfStudyKRI = dfStudyKRI,
  dfBoundsRef = lAnalysis$Analysis_BoundsRef,
  dfBounds = dfBounds,
  strStudyID = target_study,
  strYlab = "Cumulative AE Rate per Visit"
)

print(p)

# Save plot
# ggplot2::ggsave("study_comparison.png", p, width = 10, height = 6)
}

}
