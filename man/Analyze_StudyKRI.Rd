% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Analyze_StudyKRI.R
\name{Analyze_StudyKRI}
\alias{Analyze_StudyKRI}
\title{Generate Bootstrap Resamples for Study-Level KRI Analysis}
\usage{
Analyze_StudyKRI(
  dfInput,
  nBootstrapReps = 1000,
  nSites = NULL,
  strStudyCol = "StudyID",
  strGroupCol = "GroupID",
  seed = NULL
)
}
\arguments{
\item{dfInput}{data.frame. Site-level data from \code{Input_CumCountSiteByMonth}.
Expected columns: GroupID, GroupLevel, Numerator, Denominator, Metric,
StudyID, MonthYYYYMM (or custom column names specified in parameters).}

\item{nBootstrapReps}{integer. Number of bootstrap replicates to generate.
Defaults to 1000.}

\item{nSites}{integer or NULL. Number of sites to resample per replicate.
If NULL (default), uses the actual number of sites per study. If specified,
can be used to upsample (larger than actual) or downsample (smaller than actual).}

\item{strStudyCol}{character. Column name for study identifier. Defaults to "StudyID".}

\item{strGroupCol}{character. Column name for group/site identifier. Defaults to "GroupID".}

\item{seed}{integer or NULL. Random seed for reproducibility. If NULL (default),
no seed is set and results will vary between runs.}
}
\value{
A data.frame with all original columns plus:
\itemize{
\item \code{BootstrapRep}: integer, bootstrap replicate number (1 to nBootstrapReps)
\item Original data rows are replicated across bootstrap samples with sites
resampled with replacement
}
}
\description{
Generates bootstrap resamples by resampling sites/groups with replacement
within each study. This enables calculation of confidence intervals for
study-level KRI metrics through Monte Carlo simulation. Each bootstrap
replicate randomly selects sites (with replacement) and includes all their
associated data.
}
\examples{
# Generate site-level data
dfSubjects <- clindata::rawplus_dm
dfNumerator <- clindata::rawplus_ae
dfDenominator <- clindata::rawplus_visdt

dfInput <- Input_CumCountSiteByMonth(
  dfSubjects = dfSubjects,
  dfNumerator = dfNumerator,
  dfDenominator = dfDenominator,
  strNumeratorDateCol = "aest_dt",
  strDenominatorDateCol = "visit_dt"
)

# Generate bootstrap samples
dfBootstrap <- Analyze_StudyKRI(
  dfInput = dfInput,
  nBootstrapReps = 100,
  seed = 42
)

# Aggregate each bootstrap replicate to study level
dfStudyLevel <- Transform_CumCount(
  dfInput = dfBootstrap,
  vBy = c("StudyID", "BootstrapRep"),
  nMinDenominator = 25
)

print(head(dfStudyLevel))

}
